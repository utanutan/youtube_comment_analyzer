### PRD: YouTubeコメント分析による動画ネタ発見ツール

#### 1) 目的
- **目的**: 対象のYouTube動画のコメント欄を自動収集・構造化・分析し、視聴者インサイトから高精度な「動画ネタ候補」を生成・優先度付けして提示する。
- **成果物**: ダッシュボード＋エクスポート機能。テーマ別インサイト、改善点、未解決質問、視聴者要望を根拠付きで提示。

#### 2) 背景/課題
- コメント欄は視聴者の本音・要望・疑問が凝縮されているが、手動で読み解くのは非効率。
- 重複・スパム・多言語・皮肉・感情の解釈が難しく、バイアスが入りやすい。
- 競合/類似動画の差分や時系列の変化を捉える仕組みが不足。

#### 3) ゴール/KPI
- **KPI**:
  - 分析からネタ候補提示までの時間 ≤ 2分/5,000件コメント
  - 高意欲トピックの抽出再現率 ≥ 80%（人手ラベル基準）
  - 採用ネタの次回動画CTR/視聴維持率の中央値 +10%（基準比）
  - ユーザー満足度（5段階）≥ 4.2
- **定性ゴール**: 根拠（引用コメント/メトリクス）とともに意思決定の迷いを減らす。

#### 4) スコープ
- **対象**: 単一動画URL/IDのコメント収集→分析→ネタ候補提示
- **対応言語**: 日本語（英語は参考レベルでクラスタ単位サポート）
- **出力**: テーマ別要約、ネタ候補（タイトル案/角度/根拠/期待効果）、優先度スコア、CSV/PNGエクスポート

#### 5) 非スコープ（初期）
- 全自動サムネ生成・台本自動生成
- チャンネル横断の長期モニタリング
- 有料API依存の大規模多言語対応
- コメントへの自動返信・自動運用

#### 6) ペルソナ
- **個人クリエイター**: 週1–2本投稿、企画時間を短縮したい
- **編集者/企画担当**: 根拠のある提案が必要
- **マーケ担当**: 視聴者の不満/要望の早期検知

#### 7) 主要ユースケース
- 対象動画のコメントから「視聴者が次に見たい企画」を10–20件提案
- ネガ/ポジの主要論点をテーマ別に要約
- 未解決質問・要望の抽出と優先度付け
- 時系列で感情や話題がどう変化したかを可視化
- 競合動画（任意、後続）との差分インサイト提示

#### 8) 機能要件（MVP）
- **入力**: 動画URL/ID、最大取得件数、期間、言語フィルタ
- **収集**: YouTube Data API v3でコメント/返信をページング取得、重複・スパム除去、キャッシュ
- **前処理**: 言語判定、正規化、絵文字処理、引用/リンク除去、重複・類似除去、Bot/スパム検出
- **分析**:
  - 感情分析（日本語対応/皮肉耐性ベースライン）
  - キーワード抽出（TF-IDF/KeyBERT系）
  - トピックモデル（BERTopic/類似クラスタリング）
  - 時系列トレンド（感情/話題出現）
  - 有害度/攻撃性（簡易フィルタ）
  - 質問・要望抽出（疑問文/依頼表現/命名規則）
  - 代表コメント抽出（各クラスタのセンチロイド近傍）
- **ネタ候補生成**:
  - 「機会スコア」= ボリューム×関与度（いいね/返信）×未解決度×感情極性×競合飽和度（後続）
  - 候補ごとに「仮タイトル案」「角度」「想定効果」「根拠コメント」「実行メモ」
- **可視化**:
  - テーマ分布、代表コメント、感情トレンド、未解決質問リスト
  - フィルタ（期間、感情、テーマ、スパム除外）
- **出力**: ネタ候補CSV、グラフPNG、根拠コメント引用（ID/リンク）
- **状態管理**: 分析ジョブ管理、再実行、キャッシュ期限設定
- **ログ/監査**: 取得クォータ、エラー、APIレスポンス時間

#### 9) 非機能要件
- **性能**: 5,000件/≤2分、10,000件/≤5分（並列/バッチ）
- **可用性**: エラー時リトライ/再開、部分結果提示
- **拡張性**: 分析器プラガブル（感情/トピック差し替え）
- **国際化**: 日本語優先、英語はクラスタ要約レベル
- **運用**: レート制御、キャッシュ、監視、簡易アラート
- **UX**: 初回セットアップ≤3分、主要操作≤3クリック

#### 10) データ取得/前処理
- **ソース**: YouTube Data API v3（commentThreads, comments）
- **制約**: クォータ/レート制限、スレッド階層、削除済み/編集済み
- **キャッシュ**: 動画ID＋ページトークン単位、TTL 24–72h（設定可）
- **PII配慮**: 表示名/アイコンURLはマスク可能設定

#### 11) 分析ロジック（概要）
- **埋め込み**: 日本語S-BERT系（速度優先/キャッシュ）
- **クラスタ**: HDBSCAN/KMeans（コメント量で切替）
- **キーワード**: TF-IDF＋KeyBERTハイブリッド
- **感情**: 3極性（ポジ/ネガ/中立）＋強度
- **要約**: 各テーマを抽象化（抽出型→生成型順）
- **スコア**: 機会スコア正規化（0–100）、透明な内訳表示

#### 12) UI/UX（MVP画面）
- **入力画面**: URL/ID、件数、期間、言語、実行ボタン
- **結果ダッシュボード**:
  - 「ネタ候補」カード一覧（スコア順、根拠表示）
  - テーマクラスタ一覧＋代表コメント
  - 感情トレンド（期間フィルタ）
  - 未解決質問/要望タブ
  - エクスポート、再分析、除外ルール編集
- **詳細モーダル**: 候補の根拠コメント、関連指標、推奨次アクション

#### 13) API（暫定）
- POST `/analyze`（videoId, maxComments, since, lang, options）→ jobId
- GET `/analysis/{jobId}`（進捗/結果）
- GET `/analysis/{jobId}/ideas`（ネタ候補一覧）
- GET `/analysis/{jobId}/topics`（クラスタ/代表コメント）
- GET `/analysis/{jobId}/exports?type=csv|png`
- DELETE `/cache/{videoId}`

#### 14) データモデル（簡易）
- Video(videoId, title, channelId, fetchedAt)
- Comment(commentId, videoId, authorId, text, likeCount, publishedAt, parentId)
- Embedding(commentId, vector)
- Topic(topicId, videoId, label, keywords, size, sentimentSummary)
- Idea(ideaId, videoId, title, angle, opportunityScore, evidenceCommentIds[])
- AnalysisRun(jobId, videoId, params, status, metrics, createdAt)

#### 15) 技術選定（提案）
- **Backend**: Python + FastAPI（NLP/行列演算に適合）
- **NLP**: sentence-transformers（日本語S-BERT）、BERTopic、scikit-learn、spaCy/ja
- **ストレージ**: PostgreSQL/SQLite（MVPはSQLite可）、FAISS（ベクタ）
- **Frontend**: React/Next.js + Tailwind/Chakra
- **Infra**: ローカル/単一VMデプロイ（MVP）、将来Docker/K8s
- **監視**: ログ＋OpenTelemetry（任意）

#### 16) セキュリティ/プライバシー/準拠
- YouTube利用規約/Google API Services User Data Policy遵守
- アカウント/トークン安全管理（Secrets分離、最小権限）
- PII最小化（表示名マスク/リンク化、再配布制限）
- エクスポートにIDのみ含め、原文はオンデマンド取得

#### 17) リスク/対策
- **APIクォータ不足**: キャッシュ、サンプリング、夜間バッチ
- **多言語/俗語**: モデル更新、ユーザー辞書、手動タグ補助
- **スパム/皮肉**: アンサンブル判定、手動除外ルール
- **過信リスク**: スコア内訳の透明化、根拠コメント提示

#### 18) マイルストーン
- M1 収集＋前処理＋キャッシュ（1週）
- M2 基本分析（感情/キーワード/クラスタ）（1–2週）
- M3 ネタ候補生成＋スコアリング（1週）
- M4 UI/ダッシュボード/エクスポート（1週）
- M5 安定化/最適化/ドキュメント（1週）

#### 19) 受け入れ基準（例）
- URL入力→5,000件コメントで2分以内に「ネタ候補10件以上」を提示
- 各候補に根拠コメント3件以上、テーマ要約、スコア内訳が表示
- 感情トレンド、テーマ分布、未解決質問タブが動作
- CSVエクスポートに候補・テーマ・根拠コメントIDが含まれる
- 同一動画の再実行でキャッシュヒットし30秒以内に結果

#### 20) 計測/運用
- 取得/分析時間、APIエラー率、クラスタ分割数、スコア分布
- ユーザー操作（採用/除外/エクスポート）イベント
- モデルベンチ（週次、サンプルラベルで再現率監視）

#### 21) オープン課題
- 競合動画比較をMVPに含めるか（差分インサイト）
- 英語/他言語の品質水準と表示方法
- 有害度判定の閾値と誤検出時のUX
- 無料枠内のAPIクォータ戦略
- チーム利用（保存/共有/コメント）の範囲

——

次のステップとして、M1の実装計画（設計とタスク分解）に進めますか？動画URLの例があれば、それを想定データとして要件補正も可能です。


